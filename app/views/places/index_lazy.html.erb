<%= turbo_frame_tag "places" do %>
  <% @paginatable_places.zip(@place_details_list) do |place, place_details| %>
    <div class="col-md-6 mb-3 mb-md-4 mx-auto mx-md-0 px-0 px-sm-3 max-width-450">
      <div class="card p-3 position-relative">
        <div class="row">
          <div class="col-4 ps-3 pe-0">
            <%= link_to polymorphic_path([@placeable, place]), data: { turbo_frame: "modal" } do %>
              <%= image_tag place_details[:photo_url], class: "square-image w-100" %>
            <% end %>
          </div>
          <div class="col-8 px-3">
            <% if place_details[:error] %>
              <p class="error-message"><%= place_details[:error] %></p>
            <% else %>
              <%= link_to polymorphic_path([@placeable, place]), data: { turbo_frame: "modal" } do %>
                <div class="h-75">
                  <p class="pe-3 text-dark fw-bold lh-sm"><%= place_details[:name] %></p>
                  <p class="text-xs text-dark pt-1">クチコミ評価<i class="material-icons rating-icon ps-1">star</i><%= place_details[:rating] %></p>
                </div>
              <% end %>
              <%= link_to polymorphic_path([@placeable, place]), data: { turbo_method: :delete, turbo_confirm: 'このスポットをお気に入りから削除しますか？', turbo_frame: "_top" },
                class: "position-absolute top-4 end-1 text-secondary" do %>
                <i class="material-icons rounded-circle p-1 link-area">close</i>
              <% end %>
              <% if @placeable.user? %>
                <%= link_to places_select_itinerary_itineraries_path(place_id: place[:place_id]), data: { turbo_frame: "modal" }, class: "d-block mt-1 text-primary text-sm fw-bold" do %>
                  <i class="material-icons pe-1" style="vertical-align: -4.5px;">post_add</i>旅のプランに追加
                <% end %>
              <% else %>
                <%= link_to new_itinerary_schedule_path(place_id: place[:place_id]), data: { turbo_frame: "modal" }, class: "d-block mt-1 text-primary text-sm fw-bold" do %>
                  <i class="material-icons pe-1" style="vertical-align: -4.5px;">more_time</i>スケジュール作成
                <% end %>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  <%= paginate @paginatable_places, window: 1 %>
<% end %>
