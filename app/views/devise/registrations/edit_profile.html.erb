<%= render 'layouts/sidenav' %>
<main class="main-content position-relative">
  <div class="container-fluid py-5 px-sm-6 px-3">
    <div class="card card-body p-5">
      <h5 class="mb-5">プロフィールの編集</h5>
      <%= turbo_frame_tag "profile_form" do %>
        <%= form_with model: resource, url: users_update_without_password_path, local: true do |f| %>
          <div class="row mb-4 input-group">
            <div class="col-sm-3 col-form-label-lg">
              <%= image_tag resource.avatar.url, id: 'image-preview', class: "rounded-circle resize-avatar" %>
            </div>
            <div class="col-sm-8 d-flex">
              <label type="button" class="btn btn-outline-primary fw-bold mx-0 my-auto">
                <i class="material-icons opacity-10 mx-2">add_photo_alternate</i>画像を変更
                <%= f.file_field :avatar, accept: "image/*", id: "image-input", class: "d-none" %>
                <%= f.hidden_field :avatar_cache %>
              </label>
            </div>
          </div>
          <div class="row mb-4 input-group input-group-outline">
            <%= f.label :name, class: "col-sm-3 col-form-label-lg m-0 fw-bold" do %>
              ニックネーム <span class="required">*</span>
            <% end %>
            <div class="col-sm-8">
              <%= f.text_field :name, class: "form-control", autocomplete: "name", placeholder: "20文字以内で入力" %>
              <div class="<%= "error-message" if resource.errors.messages.key?(:name) %>" >
                <%= resource.errors.full_messages_for(:name).first if resource.errors.any? %>
              </div>
            </div>
          </div>
          <div class="row mb-4 input-group input-group-outline">
            <%= f.label :bestrip_id, class: "col-sm-3 col-form-label-lg m-0 fw-bold" do %>
              BesTrip ID
              <i class="bi-question-circle-fill text-warning" data-bs-toggle="tooltip" data-bs-placement="bottom"
                title="旅のプランにメンバーを追加するときに使用するIDです。設定すると友だちがあなたをID検索できるようになります。"></i>
            <% end %>
            <div class="col-sm-8">
              <%= f.text_field :bestrip_id, class: "form-control", placeholder: "半角英数字とアンダーバー(_)5〜20文字で入力" %>
              <div class="<%= "error-message" if resource.errors.messages.key?(:bestrip_id) %>" >
                <%= resource.errors.full_messages_for(:bestrip_id).first if resource.errors.any? %>
              </div>
              <%= button_tag "IDが使用可能か確認", type: :submit, formaction: :validate_bestrip_id, formmethod: :patch, class: "btn bg-gradient-light btn-sm my-1 fw-bold" %>
            </div>
          </div>
          <div class="row mb-4 input-group input-group-outline">
            <%= f.label :introduction, class: "col-sm-3 col-form-label-lg m-0 fw-bold" %>
            <div class="col-sm-8">
              <%= f.text_area :introduction, id: "text-input", class: "form-control mb-1", rows: "7", placeholder: "500文字以内で入力" %>
              <div class="d-flex justify-content-between" >
                <div></div>
                <div id="char-count" class="text-xs"><span>0</span>/500</div>
              </div>
            </div>
          </div>
          <div class="mt-3 text-center ms-auto">
            <%= f.submit "保存する", id: "btn-submit", class: "btn bg-gradient-primary mt-4 px-6 btn-lg", data: { turbo: false } %>
          </div>
        <% end %>
      <% end %>
      <div class="text-center">
        <%= link_to "アカウントを削除", registration_path(resource_name), class: "text-sm", data: { confirm: "Are you sure?", turbo_confirm: "Are you sure?" }, method: :delete %>
      </div>
    </div>
  </div>
</main>

